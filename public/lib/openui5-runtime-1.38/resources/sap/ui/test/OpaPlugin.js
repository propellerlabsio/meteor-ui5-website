/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2016 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
(function(g){"use strict";var o;if(g.module){o=g.module;g.module=undefined;}sap.ui.define(['jquery.sap.global','sap/ui/core/routing/HashChanger','sap/ui/base/Object','sap/ui/core/mvc/View','./matchers/Ancestor','./matchers/Interactable','./matchers/Visible','./pipelines/MatcherPipeline'],function($,H,U,V,A,I,a,M){var m=new M(),i=new I(),v=new a(),c=["id","viewName","controlType"];var O=U.extend("sap.ui.test.OpaPlugin",{constructor:function(l){var t=this;this._sLogPrefix=l||"";sap.ui.getCore().registerPlugin({startPlugin:function(C){t.oCore=C;},stopPlugin:function(){t.oCore=undefined;}});},getAllControls:function(C){var b,p,r=[],d=this._getCoreElements();for(p in d){if(!d.hasOwnProperty(p)){continue;}b=d[p];if(!C){r.push(b);continue;}if(b instanceof C){r.push(b);}}return r;},getView:function(s){var b=this.getAllControls(V);return b.filter(function(d){return d.getViewName()===s;})[0];},getControlInView:function(b){var s=b.viewNamespace+b.viewName,d=this.getView(s),r=[],C,e;if(!d){$.sap.log.debug("Found no view with the name: "+s,this._sLogPrefix);return null;}if($.isArray(b.id)){$.each(b.id,function(h,j){C=d.byId(j);if(C){r.push(C);}});return r;}if(typeof b.id==="string"){var E=d.byId(b.id);if(!E){$.sap.log.debug("Found no control with the id "+b.id+" in the view "+s,this._sLogPrefix);}return E;}var f=this.getAllControlsWithTheParent(d,b.controlType);if($.type(b.id)==="regexp"){e=d.getId();f=f.filter(function(C){var u=C.getId().replace(e,"");return b.id.test(u);});}return f;},getAllControlsWithTheParent:function(p,C){var b=new A(p);return this._filterUniqueControlsByCondition(this.getAllControls(C),b);},getAllControlsInContainer:function(C,f){return this._filterUniqueControlsByCondition(C.find("*").control(),function(b){if(f){return b instanceof f;}return true;});},getMatchingControls:function(b){var r;if(b.searchOpenDialogs){r=this.getAllControlsInContainer($("#sap-ui-static"),b.controlType);}else if(b.viewName){r=this.getControlInView(b);}else if(b.id){r=this.getControlByGlobalId(b);}else if(b.controlType){r=this.getAllControlsInContainer($("body"),b.controlType);}else{r=null;}if(!r||b.visible===false){return r;}var d=[];if(b.interactable){d.push(i);}else{d.push(v);}var p=m.process({control:r,matchers:d});if(!p){if($.isArray(r)){return[];}if(r){return null;}return r;}return p;},getControlByGlobalId:function(b){var t=this,s=b.id,C=[],d=[],e=this._getCoreElements();if(typeof s==="string"){C=e[s];return C&&this._checkControlType(C,b)?C:null;}if($.type(s)==="regexp"){for(var p in e){if(!e.hasOwnProperty(p)){continue;}if(!s.test(p)){continue;}d.push(p);}}else if($.isArray(s)){d=s;}return d.map(function(f){return e[f];}).filter(function(f){return t._checkControlType(f,b)&&f&&!f.bIsDestroyed;});},getControlConstructor:function(C){if(sap.ui.lazyRequire._isStub(C)){$.sap.log.debug("The control type "+C+" is currently a lazy stub. Skipped check and will wait until it is invoked","Opa5");return null;}var f=$.sap.getObject(C);if(!f){$.sap.log.debug("The control type "+C+" is undefined. Skipped check and will wait until it is required","Opa5");return null;}return f;},_isLookingForAControl:function(b){return Object.keys(b).some(function(k){return c.indexOf(k)!==-1;});},_filterUniqueControlsByCondition:function(C,f){return C.filter(function(b,p,d){var k=!!f(b);return k&&d.indexOf(b)===p;});},_getCoreElements:function(){var e={};if(!this.oCore){return e;}return this.oCore.mElements||e;},_checkControlType:function(C,b){if(b.controlType){return C instanceof b.controlType;}else{return true;}}});return O;},true);if(o){g.module=o;}})(window);
